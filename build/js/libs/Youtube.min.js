(function(root,factory){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=factory(require("video.js"))}else if(typeof define==="function"&&define.amd){define(["videojs"],function(videojs){return root.Youtube=factory(videojs)})}else{root.Youtube=factory(root.videojs)}})(this,function(videojs){"use strict";var _isOnMobile=videojs.browser.IS_IOS||videojs.browser.IS_ANDROID;var Tech=videojs.getTech("Tech");var Youtube=videojs.extend(Tech,{constructor:function(options,ready){Tech.call(this,options,ready);this.setPoster(options.poster);this.setSrc(this.options_.source,true);this.setTimeout(function(){if(this.el_){this.el_.parentNode.className+=" vjs-youtube";if(_isOnMobile){this.el_.parentNode.className+=" vjs-youtube-mobile"}if(Youtube.isApiReady){this.initYTPlayer()}else{Youtube.apiReadyQueue.push(this)}}}.bind(this))},dispose:function(){if(this.ytPlayer){if(this.ytPlayer.stopVideo){this.ytPlayer.stopVideo()}if(this.ytPlayer.destroy){this.ytPlayer.destroy()}}else{var index=Youtube.apiReadyQueue.indexOf(this);if(index!==-1){Youtube.apiReadyQueue.splice(index,1)}}this.ytPlayer=null;this.el_.parentNode.className=this.el_.parentNode.className.replace(" vjs-youtube","").replace(" vjs-youtube-mobile","");this.el_.parentNode.removeChild(this.el_);Tech.prototype.dispose.call(this)},createEl:function(){var div=document.createElement("div");div.setAttribute("id",this.options_.techId);div.setAttribute("style","width:100%;height:100%;top:0;left:0;position:absolute");div.setAttribute("class","vjs-tech");var divWrapper=document.createElement("div");divWrapper.appendChild(div);if(!_isOnMobile&&!this.options_.ytControls){var divBlocker=document.createElement("div");divBlocker.setAttribute("class","vjs-iframe-blocker");divBlocker.setAttribute("style","position:absolute;top:0;left:0;width:100%;height:100%");divBlocker.onclick=function(){this.pause()}.bind(this);divWrapper.appendChild(divBlocker)}return divWrapper},initYTPlayer:function(){var playerVars={controls:0,modestbranding:1,rel:0,showinfo:0,loop:this.options_.loop?1:0};if(typeof this.options_.autohide!=="undefined"){playerVars.autohide=this.options_.autohide}if(typeof this.options_["cc_load_policy"]!=="undefined"){playerVars["cc_load_policy"]=this.options_["cc_load_policy"]}if(typeof this.options_.ytControls!=="undefined"){playerVars.controls=this.options_.ytControls}if(typeof this.options_.disablekb!=="undefined"){playerVars.disablekb=this.options_.disablekb}if(typeof this.options_.end!=="undefined"){playerVars.end=this.options_.end}if(typeof this.options_.color!=="undefined"){playerVars.color=this.options_.color}if(!playerVars.controls){playerVars.fs=0}else if(typeof this.options_.fs!=="undefined"){playerVars.fs=this.options_.fs}if(typeof this.options_.end!=="undefined"){playerVars.end=this.options_.end}if(typeof this.options_.hl!=="undefined"){playerVars.hl=this.options_.hl}else if(typeof this.options_.language!=="undefined"){playerVars.hl=this.options_.language.substr(0,2)}if(typeof this.options_["iv_load_policy"]!=="undefined"){playerVars["iv_load_policy"]=this.options_["iv_load_policy"]}if(typeof this.options_.list!=="undefined"){playerVars.list=this.options_.list}else if(this.url&&typeof this.url.listId!=="undefined"){playerVars.list=this.url.listId}if(typeof this.options_.listType!=="undefined"){playerVars.listType=this.options_.listType}if(typeof this.options_.modestbranding!=="undefined"){playerVars.modestbranding=this.options_.modestbranding}if(typeof this.options_.playlist!=="undefined"){playerVars.playlist=this.options_.playlist}if(typeof this.options_.playsinline!=="undefined"){playerVars.playsinline=this.options_.playsinline}if(typeof this.options_.rel!=="undefined"){playerVars.rel=this.options_.rel}if(typeof this.options_.showinfo!=="undefined"){playerVars.showinfo=this.options_.showinfo}if(typeof this.options_.start!=="undefined"){playerVars.start=this.options_.start}if(typeof this.options_.theme!=="undefined"){playerVars.theme=this.options_.theme}if(typeof this.options_.customVars!=="undefined"){var customVars=this.options_.customVars;Object.keys(customVars).forEach(function(key){playerVars[key]=customVars[key]})}this.activeVideoId=this.url?this.url.videoId:null;this.activeList=playerVars.list;this.ytPlayer=new YT.Player(this.options_.techId,{videoId:this.activeVideoId,playerVars:playerVars,events:{onReady:this.onPlayerReady.bind(this),onPlaybackQualityChange:this.onPlayerPlaybackQualityChange.bind(this),onPlaybackRateChange:this.onPlayerPlaybackRateChange.bind(this),onStateChange:this.onPlayerStateChange.bind(this),onVolumeChange:this.onPlayerVolumeChange.bind(this),onError:this.onPlayerError.bind(this)}})},onPlayerReady:function(){if(this.options_.muted){this.ytPlayer.mute()}var playbackRates=this.ytPlayer.getAvailablePlaybackRates();if(playbackRates.length>1){this.featuresPlaybackRate=true}this.playerReady_=true;this.triggerReady();if(this.playOnReady){this.play()}else if(this.cueOnReady){this.cueVideoById_(this.url.videoId);this.activeVideoId=this.url.videoId}},onPlayerPlaybackQualityChange:function(){},onPlayerPlaybackRateChange:function(){this.trigger("ratechange")},onPlayerStateChange:function(e){var state=e.data;if(state===this.lastState||this.errorNumber){return}this.lastState=state;switch(state){case-1:this.trigger("loadstart");this.trigger("loadedmetadata");this.trigger("durationchange");this.trigger("ratechange");break;case YT.PlayerState.ENDED:this.trigger("ended");break;case YT.PlayerState.PLAYING:this.trigger("timeupdate");this.trigger("durationchange");this.trigger("playing");this.trigger("play");if(this.isSeeking){this.onSeeked()}break;case YT.PlayerState.PAUSED:this.trigger("canplay");if(this.isSeeking){this.onSeeked()}else{this.trigger("pause")}break;case YT.PlayerState.BUFFERING:this.player_.trigger("timeupdate");this.player_.trigger("waiting");break}},onPlayerVolumeChange:function(){this.trigger("volumechange")},onPlayerError:function(e){this.errorNumber=e.data;this.trigger("pause");this.trigger("error")},error:function(){var code=1e3+this.errorNumber;switch(this.errorNumber){case 5:return{code:code,message:"Error while trying to play the video"};case 2:case 100:return{code:code,message:"Unable to find the video"};case 101:case 150:return{code:code,message:"Playback on other Websites has been disabled by the video owner."}}return{code:code,message:"YouTube unknown error ("+this.errorNumber+")"}},loadVideoById_:function(id){var options={videoId:id};if(this.options_.start){options.startSeconds=this.options_.start}if(this.options_.end){options.endEnd=this.options_.end}this.ytPlayer.loadVideoById(options)},cueVideoById_:function(id){var options={videoId:id};if(this.options_.start){options.startSeconds=this.options_.start}if(this.options_.end){options.endEnd=this.options_.end}this.ytPlayer.cueVideoById(options)},src:function(src){if(src){this.setSrc({src:src})}return this.source},poster:function(){if(_isOnMobile){return null}return this.poster_},setPoster:function(poster){this.poster_=poster},setSrc:function(source){if(!source||!source.src){return}delete this.errorNumber;this.source=source;this.url=Youtube.parseUrl(source.src);if(!this.options_.poster){if(this.url.videoId){this.poster_="https://img.youtube.com/vi/"+this.url.videoId+"/0.jpg";this.trigger("posterchange");this.checkHighResPoster()}}if(this.options_.autoplay&&!_isOnMobile){if(this.isReady_){this.play()}else{this.playOnReady=true}}else if(this.activeVideoId!==this.url.videoId){if(this.isReady_){this.cueVideoById_(this.url.videoId);this.activeVideoId=this.url.videoId}else{this.cueOnReady=true}}},autoplay:function(){return this.options_.autoplay},setAutoplay:function(val){this.options_.autoplay=val},loop:function(){return this.options_.loop},setLoop:function(val){this.options_.loop=val},play:function(){if(!this.url||!this.url.videoId){return}this.wasPausedBeforeSeek=false;if(this.isReady_){if(this.url.listId){if(this.activeList===this.url.listId){this.ytPlayer.playVideo()}else{this.ytPlayer.loadPlaylist(this.url.listId);this.activeList=this.url.listId}}if(this.activeVideoId===this.url.videoId){this.ytPlayer.playVideo()}else{this.loadVideoById_(this.url.videoId);this.activeVideoId=this.url.videoId}}else{this.trigger("waiting");this.playOnReady=true}},pause:function(){if(this.ytPlayer){this.ytPlayer.pauseVideo()}},paused:function(){return this.ytPlayer?this.lastState!==YT.PlayerState.PLAYING&&this.lastState!==YT.PlayerState.BUFFERING:true},currentTime:function(){return this.ytPlayer?this.ytPlayer.getCurrentTime():0},setCurrentTime:function(seconds){if(this.lastState===YT.PlayerState.PAUSED){this.timeBeforeSeek=this.currentTime()}if(!this.isSeeking){this.wasPausedBeforeSeek=this.paused()}this.ytPlayer.seekTo(seconds,true);this.trigger("timeupdate");this.trigger("seeking");this.isSeeking=true;if(this.lastState===YT.PlayerState.PAUSED&&this.timeBeforeSeek!==seconds){clearInterval(this.checkSeekedInPauseInterval);this.checkSeekedInPauseInterval=setInterval(function(){if(this.lastState!==YT.PlayerState.PAUSED||!this.isSeeking){clearInterval(this.checkSeekedInPauseInterval)}else if(this.currentTime()!==this.timeBeforeSeek){this.trigger("timeupdate");this.onSeeked()}}.bind(this),250)}},seeking:function(){return this.isSeeking},seekable:function(){if(!this.ytPlayer){return videojs.createTimeRange()}return videojs.createTimeRange(0,this.ytPlayer.getDuration())},onSeeked:function(){clearInterval(this.checkSeekedInPauseInterval);this.isSeeking=false;if(this.wasPausedBeforeSeek){this.pause()}this.trigger("seeked")},playbackRate:function(){return this.ytPlayer?this.ytPlayer.getPlaybackRate():1},setPlaybackRate:function(suggestedRate){if(!this.ytPlayer){return}this.ytPlayer.setPlaybackRate(suggestedRate)},duration:function(){return this.ytPlayer?this.ytPlayer.getDuration():0},currentSrc:function(){return this.source&&this.source.src},ended:function(){return this.ytPlayer?this.lastState===YT.PlayerState.ENDED:false},volume:function(){return this.ytPlayer?this.ytPlayer.getVolume()/100:1},setVolume:function(percentAsDecimal){if(!this.ytPlayer){return}this.ytPlayer.setVolume(percentAsDecimal*100)},muted:function(){return this.ytPlayer?this.ytPlayer.isMuted():false},setMuted:function(mute){if(!this.ytPlayer){return}else{this.muted(true)}if(mute){this.ytPlayer.mute()}else{this.ytPlayer.unMute()}this.setTimeout(function(){this.trigger("volumechange")},50)},buffered:function(){if(!this.ytPlayer||!this.ytPlayer.getVideoLoadedFraction){return videojs.createTimeRange()}var bufferedEnd=this.ytPlayer.getVideoLoadedFraction()*this.ytPlayer.getDuration();return videojs.createTimeRange(0,bufferedEnd)},preload:function(){},load:function(){},reset:function(){},supportsFullScreen:function(){return true},checkHighResPoster:function(){var uri="https://img.youtube.com/vi/"+this.url.videoId+"/maxresdefault.jpg";try{var image=new Image;image.onload=function(){if("naturalHeight"in image){if(image.naturalHeight<=90||image.naturalWidth<=120){return}}else if(image.height<=90||image.width<=120){return}this.poster_=uri;this.trigger("posterchange")}.bind(this);image.onerror=function(){};image.src=uri}catch(e){}}});Youtube.isSupported=function(){return true};Youtube.canPlaySource=function(e){return Youtube.canPlayType(e.type)};Youtube.canPlayType=function(e){return e==="video/youtube"};Youtube.parseUrl=function(url){var result={videoId:null};var regex=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;var match=url.match(regex);if(match&&match[2].length===11){result.videoId=match[2]}var regPlaylist=/[?&]list=([^#\&\?]+)/;match=url.match(regPlaylist);if(match&&match[1]){result.listId=match[1]}return result};function apiLoaded(){YT.ready(function(){Youtube.isApiReady=true;for(var i=0;i<Youtube.apiReadyQueue.length;++i){Youtube.apiReadyQueue[i].initYTPlayer()}})}function loadScript(src,callback){var loaded=false;var tag=document.createElement("script");var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);tag.onload=function(){if(!loaded){loaded=true;callback()}};tag.onreadystatechange=function(){if(!loaded&&(this.readyState==="complete"||this.readyState==="loaded")){loaded=true;callback()}};tag.src=src}function injectCss(){var css=".vjs-youtube .vjs-iframe-blocker { display: none; }"+".vjs-youtube.vjs-user-inactive .vjs-iframe-blocker { display: block; }"+".vjs-youtube .vjs-poster { background-size: cover; }"+".vjs-youtube-mobile .vjs-big-play-button { display: none; }";var head=document.head||document.getElementsByTagName("head")[0];var style=document.createElement("style");style.type="text/css";if(style.styleSheet){style.styleSheet.cssText=css}else{style.appendChild(document.createTextNode(css))}head.appendChild(style)}Youtube.apiReadyQueue=[];if(typeof document!=="undefined"){loadScript("https://www.youtube.com/iframe_api",apiLoaded);injectCss()}if(typeof videojs.registerTech!=="undefined"){videojs.registerTech("Youtube",Youtube)}else{videojs.registerComponent("Youtube",Youtube)}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJsaWJzL1lvdXR1YmUubWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbihyb290LGZhY3Rvcnkpe2lmKHR5cGVvZiBleHBvcnRzPT09XCJvYmplY3RcIiYmdHlwZW9mIG1vZHVsZSE9PVwidW5kZWZpbmVkXCIpe21vZHVsZS5leHBvcnRzPWZhY3RvcnkocmVxdWlyZShcInZpZGVvLmpzXCIpKX1lbHNlIGlmKHR5cGVvZiBkZWZpbmU9PT1cImZ1bmN0aW9uXCImJmRlZmluZS5hbWQpe2RlZmluZShbXCJ2aWRlb2pzXCJdLGZ1bmN0aW9uKHZpZGVvanMpe3JldHVybiByb290LllvdXR1YmU9ZmFjdG9yeSh2aWRlb2pzKX0pfWVsc2V7cm9vdC5Zb3V0dWJlPWZhY3Rvcnkocm9vdC52aWRlb2pzKX19KSh0aGlzLGZ1bmN0aW9uKHZpZGVvanMpe1widXNlIHN0cmljdFwiO3ZhciBfaXNPbk1vYmlsZT12aWRlb2pzLmJyb3dzZXIuSVNfSU9TfHx2aWRlb2pzLmJyb3dzZXIuSVNfQU5EUk9JRDt2YXIgVGVjaD12aWRlb2pzLmdldFRlY2goXCJUZWNoXCIpO3ZhciBZb3V0dWJlPXZpZGVvanMuZXh0ZW5kKFRlY2gse2NvbnN0cnVjdG9yOmZ1bmN0aW9uKG9wdGlvbnMscmVhZHkpe1RlY2guY2FsbCh0aGlzLG9wdGlvbnMscmVhZHkpO3RoaXMuc2V0UG9zdGVyKG9wdGlvbnMucG9zdGVyKTt0aGlzLnNldFNyYyh0aGlzLm9wdGlvbnNfLnNvdXJjZSx0cnVlKTt0aGlzLnNldFRpbWVvdXQoZnVuY3Rpb24oKXtpZih0aGlzLmVsXyl7dGhpcy5lbF8ucGFyZW50Tm9kZS5jbGFzc05hbWUrPVwiIHZqcy15b3V0dWJlXCI7aWYoX2lzT25Nb2JpbGUpe3RoaXMuZWxfLnBhcmVudE5vZGUuY2xhc3NOYW1lKz1cIiB2anMteW91dHViZS1tb2JpbGVcIn1pZihZb3V0dWJlLmlzQXBpUmVhZHkpe3RoaXMuaW5pdFlUUGxheWVyKCl9ZWxzZXtZb3V0dWJlLmFwaVJlYWR5UXVldWUucHVzaCh0aGlzKX19fS5iaW5kKHRoaXMpKX0sZGlzcG9zZTpmdW5jdGlvbigpe2lmKHRoaXMueXRQbGF5ZXIpe2lmKHRoaXMueXRQbGF5ZXIuc3RvcFZpZGVvKXt0aGlzLnl0UGxheWVyLnN0b3BWaWRlbygpfWlmKHRoaXMueXRQbGF5ZXIuZGVzdHJveSl7dGhpcy55dFBsYXllci5kZXN0cm95KCl9fWVsc2V7dmFyIGluZGV4PVlvdXR1YmUuYXBpUmVhZHlRdWV1ZS5pbmRleE9mKHRoaXMpO2lmKGluZGV4IT09LTEpe1lvdXR1YmUuYXBpUmVhZHlRdWV1ZS5zcGxpY2UoaW5kZXgsMSl9fXRoaXMueXRQbGF5ZXI9bnVsbDt0aGlzLmVsXy5wYXJlbnROb2RlLmNsYXNzTmFtZT10aGlzLmVsXy5wYXJlbnROb2RlLmNsYXNzTmFtZS5yZXBsYWNlKFwiIHZqcy15b3V0dWJlXCIsXCJcIikucmVwbGFjZShcIiB2anMteW91dHViZS1tb2JpbGVcIixcIlwiKTt0aGlzLmVsXy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZWxfKTtUZWNoLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyl9LGNyZWF0ZUVsOmZ1bmN0aW9uKCl7dmFyIGRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2Rpdi5zZXRBdHRyaWJ1dGUoXCJpZFwiLHRoaXMub3B0aW9uc18udGVjaElkKTtkaXYuc2V0QXR0cmlidXRlKFwic3R5bGVcIixcIndpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7dG9wOjA7bGVmdDowO3Bvc2l0aW9uOmFic29sdXRlXCIpO2Rpdi5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLFwidmpzLXRlY2hcIik7dmFyIGRpdldyYXBwZXI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtkaXZXcmFwcGVyLmFwcGVuZENoaWxkKGRpdik7aWYoIV9pc09uTW9iaWxlJiYhdGhpcy5vcHRpb25zXy55dENvbnRyb2xzKXt2YXIgZGl2QmxvY2tlcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2RpdkJsb2NrZXIuc2V0QXR0cmlidXRlKFwiY2xhc3NcIixcInZqcy1pZnJhbWUtYmxvY2tlclwiKTtkaXZCbG9ja2VyLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsXCJwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJVwiKTtkaXZCbG9ja2VyLm9uY2xpY2s9ZnVuY3Rpb24oKXt0aGlzLnBhdXNlKCl9LmJpbmQodGhpcyk7ZGl2V3JhcHBlci5hcHBlbmRDaGlsZChkaXZCbG9ja2VyKX1yZXR1cm4gZGl2V3JhcHBlcn0saW5pdFlUUGxheWVyOmZ1bmN0aW9uKCl7dmFyIHBsYXllclZhcnM9e2NvbnRyb2xzOjAsbW9kZXN0YnJhbmRpbmc6MSxyZWw6MCxzaG93aW5mbzowLGxvb3A6dGhpcy5vcHRpb25zXy5sb29wPzE6MH07aWYodHlwZW9mIHRoaXMub3B0aW9uc18uYXV0b2hpZGUhPT1cInVuZGVmaW5lZFwiKXtwbGF5ZXJWYXJzLmF1dG9oaWRlPXRoaXMub3B0aW9uc18uYXV0b2hpZGV9aWYodHlwZW9mIHRoaXMub3B0aW9uc19bXCJjY19sb2FkX3BvbGljeVwiXSE9PVwidW5kZWZpbmVkXCIpe3BsYXllclZhcnNbXCJjY19sb2FkX3BvbGljeVwiXT10aGlzLm9wdGlvbnNfW1wiY2NfbG9hZF9wb2xpY3lcIl19aWYodHlwZW9mIHRoaXMub3B0aW9uc18ueXRDb250cm9scyE9PVwidW5kZWZpbmVkXCIpe3BsYXllclZhcnMuY29udHJvbHM9dGhpcy5vcHRpb25zXy55dENvbnRyb2xzfWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLmRpc2FibGVrYiE9PVwidW5kZWZpbmVkXCIpe3BsYXllclZhcnMuZGlzYWJsZWtiPXRoaXMub3B0aW9uc18uZGlzYWJsZWtifWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLmVuZCE9PVwidW5kZWZpbmVkXCIpe3BsYXllclZhcnMuZW5kPXRoaXMub3B0aW9uc18uZW5kfWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLmNvbG9yIT09XCJ1bmRlZmluZWRcIil7cGxheWVyVmFycy5jb2xvcj10aGlzLm9wdGlvbnNfLmNvbG9yfWlmKCFwbGF5ZXJWYXJzLmNvbnRyb2xzKXtwbGF5ZXJWYXJzLmZzPTB9ZWxzZSBpZih0eXBlb2YgdGhpcy5vcHRpb25zXy5mcyE9PVwidW5kZWZpbmVkXCIpe3BsYXllclZhcnMuZnM9dGhpcy5vcHRpb25zXy5mc31pZih0eXBlb2YgdGhpcy5vcHRpb25zXy5lbmQhPT1cInVuZGVmaW5lZFwiKXtwbGF5ZXJWYXJzLmVuZD10aGlzLm9wdGlvbnNfLmVuZH1pZih0eXBlb2YgdGhpcy5vcHRpb25zXy5obCE9PVwidW5kZWZpbmVkXCIpe3BsYXllclZhcnMuaGw9dGhpcy5vcHRpb25zXy5obH1lbHNlIGlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLmxhbmd1YWdlIT09XCJ1bmRlZmluZWRcIil7cGxheWVyVmFycy5obD10aGlzLm9wdGlvbnNfLmxhbmd1YWdlLnN1YnN0cigwLDIpfWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfW1wiaXZfbG9hZF9wb2xpY3lcIl0hPT1cInVuZGVmaW5lZFwiKXtwbGF5ZXJWYXJzW1wiaXZfbG9hZF9wb2xpY3lcIl09dGhpcy5vcHRpb25zX1tcIml2X2xvYWRfcG9saWN5XCJdfWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLmxpc3QhPT1cInVuZGVmaW5lZFwiKXtwbGF5ZXJWYXJzLmxpc3Q9dGhpcy5vcHRpb25zXy5saXN0fWVsc2UgaWYodGhpcy51cmwmJnR5cGVvZiB0aGlzLnVybC5saXN0SWQhPT1cInVuZGVmaW5lZFwiKXtwbGF5ZXJWYXJzLmxpc3Q9dGhpcy51cmwubGlzdElkfWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLmxpc3RUeXBlIT09XCJ1bmRlZmluZWRcIil7cGxheWVyVmFycy5saXN0VHlwZT10aGlzLm9wdGlvbnNfLmxpc3RUeXBlfWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLm1vZGVzdGJyYW5kaW5nIT09XCJ1bmRlZmluZWRcIil7cGxheWVyVmFycy5tb2Rlc3RicmFuZGluZz10aGlzLm9wdGlvbnNfLm1vZGVzdGJyYW5kaW5nfWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLnBsYXlsaXN0IT09XCJ1bmRlZmluZWRcIil7cGxheWVyVmFycy5wbGF5bGlzdD10aGlzLm9wdGlvbnNfLnBsYXlsaXN0fWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLnBsYXlzaW5saW5lIT09XCJ1bmRlZmluZWRcIil7cGxheWVyVmFycy5wbGF5c2lubGluZT10aGlzLm9wdGlvbnNfLnBsYXlzaW5saW5lfWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLnJlbCE9PVwidW5kZWZpbmVkXCIpe3BsYXllclZhcnMucmVsPXRoaXMub3B0aW9uc18ucmVsfWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLnNob3dpbmZvIT09XCJ1bmRlZmluZWRcIil7cGxheWVyVmFycy5zaG93aW5mbz10aGlzLm9wdGlvbnNfLnNob3dpbmZvfWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLnN0YXJ0IT09XCJ1bmRlZmluZWRcIil7cGxheWVyVmFycy5zdGFydD10aGlzLm9wdGlvbnNfLnN0YXJ0fWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLnRoZW1lIT09XCJ1bmRlZmluZWRcIil7cGxheWVyVmFycy50aGVtZT10aGlzLm9wdGlvbnNfLnRoZW1lfWlmKHR5cGVvZiB0aGlzLm9wdGlvbnNfLmN1c3RvbVZhcnMhPT1cInVuZGVmaW5lZFwiKXt2YXIgY3VzdG9tVmFycz10aGlzLm9wdGlvbnNfLmN1c3RvbVZhcnM7T2JqZWN0LmtleXMoY3VzdG9tVmFycykuZm9yRWFjaChmdW5jdGlvbihrZXkpe3BsYXllclZhcnNba2V5XT1jdXN0b21WYXJzW2tleV19KX10aGlzLmFjdGl2ZVZpZGVvSWQ9dGhpcy51cmw/dGhpcy51cmwudmlkZW9JZDpudWxsO3RoaXMuYWN0aXZlTGlzdD1wbGF5ZXJWYXJzLmxpc3Q7dGhpcy55dFBsYXllcj1uZXcgWVQuUGxheWVyKHRoaXMub3B0aW9uc18udGVjaElkLHt2aWRlb0lkOnRoaXMuYWN0aXZlVmlkZW9JZCxwbGF5ZXJWYXJzOnBsYXllclZhcnMsZXZlbnRzOntvblJlYWR5OnRoaXMub25QbGF5ZXJSZWFkeS5iaW5kKHRoaXMpLG9uUGxheWJhY2tRdWFsaXR5Q2hhbmdlOnRoaXMub25QbGF5ZXJQbGF5YmFja1F1YWxpdHlDaGFuZ2UuYmluZCh0aGlzKSxvblBsYXliYWNrUmF0ZUNoYW5nZTp0aGlzLm9uUGxheWVyUGxheWJhY2tSYXRlQ2hhbmdlLmJpbmQodGhpcyksb25TdGF0ZUNoYW5nZTp0aGlzLm9uUGxheWVyU3RhdGVDaGFuZ2UuYmluZCh0aGlzKSxvblZvbHVtZUNoYW5nZTp0aGlzLm9uUGxheWVyVm9sdW1lQ2hhbmdlLmJpbmQodGhpcyksb25FcnJvcjp0aGlzLm9uUGxheWVyRXJyb3IuYmluZCh0aGlzKX19KX0sb25QbGF5ZXJSZWFkeTpmdW5jdGlvbigpe2lmKHRoaXMub3B0aW9uc18ubXV0ZWQpe3RoaXMueXRQbGF5ZXIubXV0ZSgpfXZhciBwbGF5YmFja1JhdGVzPXRoaXMueXRQbGF5ZXIuZ2V0QXZhaWxhYmxlUGxheWJhY2tSYXRlcygpO2lmKHBsYXliYWNrUmF0ZXMubGVuZ3RoPjEpe3RoaXMuZmVhdHVyZXNQbGF5YmFja1JhdGU9dHJ1ZX10aGlzLnBsYXllclJlYWR5Xz10cnVlO3RoaXMudHJpZ2dlclJlYWR5KCk7aWYodGhpcy5wbGF5T25SZWFkeSl7dGhpcy5wbGF5KCl9ZWxzZSBpZih0aGlzLmN1ZU9uUmVhZHkpe3RoaXMuY3VlVmlkZW9CeUlkXyh0aGlzLnVybC52aWRlb0lkKTt0aGlzLmFjdGl2ZVZpZGVvSWQ9dGhpcy51cmwudmlkZW9JZH19LG9uUGxheWVyUGxheWJhY2tRdWFsaXR5Q2hhbmdlOmZ1bmN0aW9uKCl7fSxvblBsYXllclBsYXliYWNrUmF0ZUNoYW5nZTpmdW5jdGlvbigpe3RoaXMudHJpZ2dlcihcInJhdGVjaGFuZ2VcIil9LG9uUGxheWVyU3RhdGVDaGFuZ2U6ZnVuY3Rpb24oZSl7dmFyIHN0YXRlPWUuZGF0YTtpZihzdGF0ZT09PXRoaXMubGFzdFN0YXRlfHx0aGlzLmVycm9yTnVtYmVyKXtyZXR1cm59dGhpcy5sYXN0U3RhdGU9c3RhdGU7c3dpdGNoKHN0YXRlKXtjYXNlLTE6dGhpcy50cmlnZ2VyKFwibG9hZHN0YXJ0XCIpO3RoaXMudHJpZ2dlcihcImxvYWRlZG1ldGFkYXRhXCIpO3RoaXMudHJpZ2dlcihcImR1cmF0aW9uY2hhbmdlXCIpO3RoaXMudHJpZ2dlcihcInJhdGVjaGFuZ2VcIik7YnJlYWs7Y2FzZSBZVC5QbGF5ZXJTdGF0ZS5FTkRFRDp0aGlzLnRyaWdnZXIoXCJlbmRlZFwiKTticmVhaztjYXNlIFlULlBsYXllclN0YXRlLlBMQVlJTkc6dGhpcy50cmlnZ2VyKFwidGltZXVwZGF0ZVwiKTt0aGlzLnRyaWdnZXIoXCJkdXJhdGlvbmNoYW5nZVwiKTt0aGlzLnRyaWdnZXIoXCJwbGF5aW5nXCIpO3RoaXMudHJpZ2dlcihcInBsYXlcIik7aWYodGhpcy5pc1NlZWtpbmcpe3RoaXMub25TZWVrZWQoKX1icmVhaztjYXNlIFlULlBsYXllclN0YXRlLlBBVVNFRDp0aGlzLnRyaWdnZXIoXCJjYW5wbGF5XCIpO2lmKHRoaXMuaXNTZWVraW5nKXt0aGlzLm9uU2Vla2VkKCl9ZWxzZXt0aGlzLnRyaWdnZXIoXCJwYXVzZVwiKX1icmVhaztjYXNlIFlULlBsYXllclN0YXRlLkJVRkZFUklORzp0aGlzLnBsYXllcl8udHJpZ2dlcihcInRpbWV1cGRhdGVcIik7dGhpcy5wbGF5ZXJfLnRyaWdnZXIoXCJ3YWl0aW5nXCIpO2JyZWFrfX0sb25QbGF5ZXJWb2x1bWVDaGFuZ2U6ZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXIoXCJ2b2x1bWVjaGFuZ2VcIil9LG9uUGxheWVyRXJyb3I6ZnVuY3Rpb24oZSl7dGhpcy5lcnJvck51bWJlcj1lLmRhdGE7dGhpcy50cmlnZ2VyKFwicGF1c2VcIik7dGhpcy50cmlnZ2VyKFwiZXJyb3JcIil9LGVycm9yOmZ1bmN0aW9uKCl7dmFyIGNvZGU9MWUzK3RoaXMuZXJyb3JOdW1iZXI7c3dpdGNoKHRoaXMuZXJyb3JOdW1iZXIpe2Nhc2UgNTpyZXR1cm57Y29kZTpjb2RlLG1lc3NhZ2U6XCJFcnJvciB3aGlsZSB0cnlpbmcgdG8gcGxheSB0aGUgdmlkZW9cIn07Y2FzZSAyOmNhc2UgMTAwOnJldHVybntjb2RlOmNvZGUsbWVzc2FnZTpcIlVuYWJsZSB0byBmaW5kIHRoZSB2aWRlb1wifTtjYXNlIDEwMTpjYXNlIDE1MDpyZXR1cm57Y29kZTpjb2RlLG1lc3NhZ2U6XCJQbGF5YmFjayBvbiBvdGhlciBXZWJzaXRlcyBoYXMgYmVlbiBkaXNhYmxlZCBieSB0aGUgdmlkZW8gb3duZXIuXCJ9fXJldHVybntjb2RlOmNvZGUsbWVzc2FnZTpcIllvdVR1YmUgdW5rbm93biBlcnJvciAoXCIrdGhpcy5lcnJvck51bWJlcitcIilcIn19LGxvYWRWaWRlb0J5SWRfOmZ1bmN0aW9uKGlkKXt2YXIgb3B0aW9ucz17dmlkZW9JZDppZH07aWYodGhpcy5vcHRpb25zXy5zdGFydCl7b3B0aW9ucy5zdGFydFNlY29uZHM9dGhpcy5vcHRpb25zXy5zdGFydH1pZih0aGlzLm9wdGlvbnNfLmVuZCl7b3B0aW9ucy5lbmRFbmQ9dGhpcy5vcHRpb25zXy5lbmR9dGhpcy55dFBsYXllci5sb2FkVmlkZW9CeUlkKG9wdGlvbnMpfSxjdWVWaWRlb0J5SWRfOmZ1bmN0aW9uKGlkKXt2YXIgb3B0aW9ucz17dmlkZW9JZDppZH07aWYodGhpcy5vcHRpb25zXy5zdGFydCl7b3B0aW9ucy5zdGFydFNlY29uZHM9dGhpcy5vcHRpb25zXy5zdGFydH1pZih0aGlzLm9wdGlvbnNfLmVuZCl7b3B0aW9ucy5lbmRFbmQ9dGhpcy5vcHRpb25zXy5lbmR9dGhpcy55dFBsYXllci5jdWVWaWRlb0J5SWQob3B0aW9ucyl9LHNyYzpmdW5jdGlvbihzcmMpe2lmKHNyYyl7dGhpcy5zZXRTcmMoe3NyYzpzcmN9KX1yZXR1cm4gdGhpcy5zb3VyY2V9LHBvc3RlcjpmdW5jdGlvbigpe2lmKF9pc09uTW9iaWxlKXtyZXR1cm4gbnVsbH1yZXR1cm4gdGhpcy5wb3N0ZXJffSxzZXRQb3N0ZXI6ZnVuY3Rpb24ocG9zdGVyKXt0aGlzLnBvc3Rlcl89cG9zdGVyfSxzZXRTcmM6ZnVuY3Rpb24oc291cmNlKXtpZighc291cmNlfHwhc291cmNlLnNyYyl7cmV0dXJufWRlbGV0ZSB0aGlzLmVycm9yTnVtYmVyO3RoaXMuc291cmNlPXNvdXJjZTt0aGlzLnVybD1Zb3V0dWJlLnBhcnNlVXJsKHNvdXJjZS5zcmMpO2lmKCF0aGlzLm9wdGlvbnNfLnBvc3Rlcil7aWYodGhpcy51cmwudmlkZW9JZCl7dGhpcy5wb3N0ZXJfPVwiaHR0cHM6Ly9pbWcueW91dHViZS5jb20vdmkvXCIrdGhpcy51cmwudmlkZW9JZCtcIi8wLmpwZ1wiO3RoaXMudHJpZ2dlcihcInBvc3RlcmNoYW5nZVwiKTt0aGlzLmNoZWNrSGlnaFJlc1Bvc3RlcigpfX1pZih0aGlzLm9wdGlvbnNfLmF1dG9wbGF5JiYhX2lzT25Nb2JpbGUpe2lmKHRoaXMuaXNSZWFkeV8pe3RoaXMucGxheSgpfWVsc2V7dGhpcy5wbGF5T25SZWFkeT10cnVlfX1lbHNlIGlmKHRoaXMuYWN0aXZlVmlkZW9JZCE9PXRoaXMudXJsLnZpZGVvSWQpe2lmKHRoaXMuaXNSZWFkeV8pe3RoaXMuY3VlVmlkZW9CeUlkXyh0aGlzLnVybC52aWRlb0lkKTt0aGlzLmFjdGl2ZVZpZGVvSWQ9dGhpcy51cmwudmlkZW9JZH1lbHNle3RoaXMuY3VlT25SZWFkeT10cnVlfX19LGF1dG9wbGF5OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3B0aW9uc18uYXV0b3BsYXl9LHNldEF1dG9wbGF5OmZ1bmN0aW9uKHZhbCl7dGhpcy5vcHRpb25zXy5hdXRvcGxheT12YWx9LGxvb3A6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcHRpb25zXy5sb29wfSxzZXRMb29wOmZ1bmN0aW9uKHZhbCl7dGhpcy5vcHRpb25zXy5sb29wPXZhbH0scGxheTpmdW5jdGlvbigpe2lmKCF0aGlzLnVybHx8IXRoaXMudXJsLnZpZGVvSWQpe3JldHVybn10aGlzLndhc1BhdXNlZEJlZm9yZVNlZWs9ZmFsc2U7aWYodGhpcy5pc1JlYWR5Xyl7aWYodGhpcy51cmwubGlzdElkKXtpZih0aGlzLmFjdGl2ZUxpc3Q9PT10aGlzLnVybC5saXN0SWQpe3RoaXMueXRQbGF5ZXIucGxheVZpZGVvKCl9ZWxzZXt0aGlzLnl0UGxheWVyLmxvYWRQbGF5bGlzdCh0aGlzLnVybC5saXN0SWQpO3RoaXMuYWN0aXZlTGlzdD10aGlzLnVybC5saXN0SWR9fWlmKHRoaXMuYWN0aXZlVmlkZW9JZD09PXRoaXMudXJsLnZpZGVvSWQpe3RoaXMueXRQbGF5ZXIucGxheVZpZGVvKCl9ZWxzZXt0aGlzLmxvYWRWaWRlb0J5SWRfKHRoaXMudXJsLnZpZGVvSWQpO3RoaXMuYWN0aXZlVmlkZW9JZD10aGlzLnVybC52aWRlb0lkfX1lbHNle3RoaXMudHJpZ2dlcihcIndhaXRpbmdcIik7dGhpcy5wbGF5T25SZWFkeT10cnVlfX0scGF1c2U6ZnVuY3Rpb24oKXtpZih0aGlzLnl0UGxheWVyKXt0aGlzLnl0UGxheWVyLnBhdXNlVmlkZW8oKX19LHBhdXNlZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnl0UGxheWVyP3RoaXMubGFzdFN0YXRlIT09WVQuUGxheWVyU3RhdGUuUExBWUlORyYmdGhpcy5sYXN0U3RhdGUhPT1ZVC5QbGF5ZXJTdGF0ZS5CVUZGRVJJTkc6dHJ1ZX0sY3VycmVudFRpbWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy55dFBsYXllcj90aGlzLnl0UGxheWVyLmdldEN1cnJlbnRUaW1lKCk6MH0sc2V0Q3VycmVudFRpbWU6ZnVuY3Rpb24oc2Vjb25kcyl7aWYodGhpcy5sYXN0U3RhdGU9PT1ZVC5QbGF5ZXJTdGF0ZS5QQVVTRUQpe3RoaXMudGltZUJlZm9yZVNlZWs9dGhpcy5jdXJyZW50VGltZSgpfWlmKCF0aGlzLmlzU2Vla2luZyl7dGhpcy53YXNQYXVzZWRCZWZvcmVTZWVrPXRoaXMucGF1c2VkKCl9dGhpcy55dFBsYXllci5zZWVrVG8oc2Vjb25kcyx0cnVlKTt0aGlzLnRyaWdnZXIoXCJ0aW1ldXBkYXRlXCIpO3RoaXMudHJpZ2dlcihcInNlZWtpbmdcIik7dGhpcy5pc1NlZWtpbmc9dHJ1ZTtpZih0aGlzLmxhc3RTdGF0ZT09PVlULlBsYXllclN0YXRlLlBBVVNFRCYmdGhpcy50aW1lQmVmb3JlU2VlayE9PXNlY29uZHMpe2NsZWFySW50ZXJ2YWwodGhpcy5jaGVja1NlZWtlZEluUGF1c2VJbnRlcnZhbCk7dGhpcy5jaGVja1NlZWtlZEluUGF1c2VJbnRlcnZhbD1zZXRJbnRlcnZhbChmdW5jdGlvbigpe2lmKHRoaXMubGFzdFN0YXRlIT09WVQuUGxheWVyU3RhdGUuUEFVU0VEfHwhdGhpcy5pc1NlZWtpbmcpe2NsZWFySW50ZXJ2YWwodGhpcy5jaGVja1NlZWtlZEluUGF1c2VJbnRlcnZhbCl9ZWxzZSBpZih0aGlzLmN1cnJlbnRUaW1lKCkhPT10aGlzLnRpbWVCZWZvcmVTZWVrKXt0aGlzLnRyaWdnZXIoXCJ0aW1ldXBkYXRlXCIpO3RoaXMub25TZWVrZWQoKX19LmJpbmQodGhpcyksMjUwKX19LHNlZWtpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc1NlZWtpbmd9LHNlZWthYmxlOmZ1bmN0aW9uKCl7aWYoIXRoaXMueXRQbGF5ZXIpe3JldHVybiB2aWRlb2pzLmNyZWF0ZVRpbWVSYW5nZSgpfXJldHVybiB2aWRlb2pzLmNyZWF0ZVRpbWVSYW5nZSgwLHRoaXMueXRQbGF5ZXIuZ2V0RHVyYXRpb24oKSl9LG9uU2Vla2VkOmZ1bmN0aW9uKCl7Y2xlYXJJbnRlcnZhbCh0aGlzLmNoZWNrU2Vla2VkSW5QYXVzZUludGVydmFsKTt0aGlzLmlzU2Vla2luZz1mYWxzZTtpZih0aGlzLndhc1BhdXNlZEJlZm9yZVNlZWspe3RoaXMucGF1c2UoKX10aGlzLnRyaWdnZXIoXCJzZWVrZWRcIil9LHBsYXliYWNrUmF0ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnl0UGxheWVyP3RoaXMueXRQbGF5ZXIuZ2V0UGxheWJhY2tSYXRlKCk6MX0sc2V0UGxheWJhY2tSYXRlOmZ1bmN0aW9uKHN1Z2dlc3RlZFJhdGUpe2lmKCF0aGlzLnl0UGxheWVyKXtyZXR1cm59dGhpcy55dFBsYXllci5zZXRQbGF5YmFja1JhdGUoc3VnZ2VzdGVkUmF0ZSl9LGR1cmF0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueXRQbGF5ZXI/dGhpcy55dFBsYXllci5nZXREdXJhdGlvbigpOjB9LGN1cnJlbnRTcmM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zb3VyY2UmJnRoaXMuc291cmNlLnNyY30sZW5kZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy55dFBsYXllcj90aGlzLmxhc3RTdGF0ZT09PVlULlBsYXllclN0YXRlLkVOREVEOmZhbHNlfSx2b2x1bWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy55dFBsYXllcj90aGlzLnl0UGxheWVyLmdldFZvbHVtZSgpLzEwMDoxfSxzZXRWb2x1bWU6ZnVuY3Rpb24ocGVyY2VudEFzRGVjaW1hbCl7aWYoIXRoaXMueXRQbGF5ZXIpe3JldHVybn10aGlzLnl0UGxheWVyLnNldFZvbHVtZShwZXJjZW50QXNEZWNpbWFsKjEwMCl9LG11dGVkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMueXRQbGF5ZXI/dGhpcy55dFBsYXllci5pc011dGVkKCk6ZmFsc2V9LHNldE11dGVkOmZ1bmN0aW9uKG11dGUpe2lmKCF0aGlzLnl0UGxheWVyKXtyZXR1cm59ZWxzZXt0aGlzLm11dGVkKHRydWUpfWlmKG11dGUpe3RoaXMueXRQbGF5ZXIubXV0ZSgpfWVsc2V7dGhpcy55dFBsYXllci51bk11dGUoKX10aGlzLnNldFRpbWVvdXQoZnVuY3Rpb24oKXt0aGlzLnRyaWdnZXIoXCJ2b2x1bWVjaGFuZ2VcIil9LDUwKX0sYnVmZmVyZWQ6ZnVuY3Rpb24oKXtpZighdGhpcy55dFBsYXllcnx8IXRoaXMueXRQbGF5ZXIuZ2V0VmlkZW9Mb2FkZWRGcmFjdGlvbil7cmV0dXJuIHZpZGVvanMuY3JlYXRlVGltZVJhbmdlKCl9dmFyIGJ1ZmZlcmVkRW5kPXRoaXMueXRQbGF5ZXIuZ2V0VmlkZW9Mb2FkZWRGcmFjdGlvbigpKnRoaXMueXRQbGF5ZXIuZ2V0RHVyYXRpb24oKTtyZXR1cm4gdmlkZW9qcy5jcmVhdGVUaW1lUmFuZ2UoMCxidWZmZXJlZEVuZCl9LHByZWxvYWQ6ZnVuY3Rpb24oKXt9LGxvYWQ6ZnVuY3Rpb24oKXt9LHJlc2V0OmZ1bmN0aW9uKCl7fSxzdXBwb3J0c0Z1bGxTY3JlZW46ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZX0sY2hlY2tIaWdoUmVzUG9zdGVyOmZ1bmN0aW9uKCl7dmFyIHVyaT1cImh0dHBzOi8vaW1nLnlvdXR1YmUuY29tL3ZpL1wiK3RoaXMudXJsLnZpZGVvSWQrXCIvbWF4cmVzZGVmYXVsdC5qcGdcIjt0cnl7dmFyIGltYWdlPW5ldyBJbWFnZTtpbWFnZS5vbmxvYWQ9ZnVuY3Rpb24oKXtpZihcIm5hdHVyYWxIZWlnaHRcImluIGltYWdlKXtpZihpbWFnZS5uYXR1cmFsSGVpZ2h0PD05MHx8aW1hZ2UubmF0dXJhbFdpZHRoPD0xMjApe3JldHVybn19ZWxzZSBpZihpbWFnZS5oZWlnaHQ8PTkwfHxpbWFnZS53aWR0aDw9MTIwKXtyZXR1cm59dGhpcy5wb3N0ZXJfPXVyaTt0aGlzLnRyaWdnZXIoXCJwb3N0ZXJjaGFuZ2VcIil9LmJpbmQodGhpcyk7aW1hZ2Uub25lcnJvcj1mdW5jdGlvbigpe307aW1hZ2Uuc3JjPXVyaX1jYXRjaChlKXt9fX0pO1lvdXR1YmUuaXNTdXBwb3J0ZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZX07WW91dHViZS5jYW5QbGF5U291cmNlPWZ1bmN0aW9uKGUpe3JldHVybiBZb3V0dWJlLmNhblBsYXlUeXBlKGUudHlwZSl9O1lvdXR1YmUuY2FuUGxheVR5cGU9ZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT1cInZpZGVvL3lvdXR1YmVcIn07WW91dHViZS5wYXJzZVVybD1mdW5jdGlvbih1cmwpe3ZhciByZXN1bHQ9e3ZpZGVvSWQ6bnVsbH07dmFyIHJlZ2V4PS9eLiooeW91dHUuYmVcXC98dlxcL3x1XFwvXFx3XFwvfGVtYmVkXFwvfHdhdGNoXFw/dj18XFwmdj0pKFteI1xcJlxcP10qKS4qLzt2YXIgbWF0Y2g9dXJsLm1hdGNoKHJlZ2V4KTtpZihtYXRjaCYmbWF0Y2hbMl0ubGVuZ3RoPT09MTEpe3Jlc3VsdC52aWRlb0lkPW1hdGNoWzJdfXZhciByZWdQbGF5bGlzdD0vWz8mXWxpc3Q9KFteI1xcJlxcP10rKS87bWF0Y2g9dXJsLm1hdGNoKHJlZ1BsYXlsaXN0KTtpZihtYXRjaCYmbWF0Y2hbMV0pe3Jlc3VsdC5saXN0SWQ9bWF0Y2hbMV19cmV0dXJuIHJlc3VsdH07ZnVuY3Rpb24gYXBpTG9hZGVkKCl7WVQucmVhZHkoZnVuY3Rpb24oKXtZb3V0dWJlLmlzQXBpUmVhZHk9dHJ1ZTtmb3IodmFyIGk9MDtpPFlvdXR1YmUuYXBpUmVhZHlRdWV1ZS5sZW5ndGg7KytpKXtZb3V0dWJlLmFwaVJlYWR5UXVldWVbaV0uaW5pdFlUUGxheWVyKCl9fSl9ZnVuY3Rpb24gbG9hZFNjcmlwdChzcmMsY2FsbGJhY2spe3ZhciBsb2FkZWQ9ZmFsc2U7dmFyIHRhZz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO3ZhciBmaXJzdFNjcmlwdFRhZz1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKVswXTtmaXJzdFNjcmlwdFRhZy5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0YWcsZmlyc3RTY3JpcHRUYWcpO3RhZy5vbmxvYWQ9ZnVuY3Rpb24oKXtpZighbG9hZGVkKXtsb2FkZWQ9dHJ1ZTtjYWxsYmFjaygpfX07dGFnLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpe2lmKCFsb2FkZWQmJih0aGlzLnJlYWR5U3RhdGU9PT1cImNvbXBsZXRlXCJ8fHRoaXMucmVhZHlTdGF0ZT09PVwibG9hZGVkXCIpKXtsb2FkZWQ9dHJ1ZTtjYWxsYmFjaygpfX07dGFnLnNyYz1zcmN9ZnVuY3Rpb24gaW5qZWN0Q3NzKCl7dmFyIGNzcz1cIi52anMteW91dHViZSAudmpzLWlmcmFtZS1ibG9ja2VyIHsgZGlzcGxheTogbm9uZTsgfVwiK1wiLnZqcy15b3V0dWJlLnZqcy11c2VyLWluYWN0aXZlIC52anMtaWZyYW1lLWJsb2NrZXIgeyBkaXNwbGF5OiBibG9jazsgfVwiK1wiLnZqcy15b3V0dWJlIC52anMtcG9zdGVyIHsgYmFja2dyb3VuZC1zaXplOiBjb3ZlcjsgfVwiK1wiLnZqcy15b3V0dWJlLW1vYmlsZSAudmpzLWJpZy1wbGF5LWJ1dHRvbiB7IGRpc3BsYXk6IG5vbmU7IH1cIjt2YXIgaGVhZD1kb2N1bWVudC5oZWFkfHxkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF07dmFyIHN0eWxlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtzdHlsZS50eXBlPVwidGV4dC9jc3NcIjtpZihzdHlsZS5zdHlsZVNoZWV0KXtzdHlsZS5zdHlsZVNoZWV0LmNzc1RleHQ9Y3NzfWVsc2V7c3R5bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKSl9aGVhZC5hcHBlbmRDaGlsZChzdHlsZSl9WW91dHViZS5hcGlSZWFkeVF1ZXVlPVtdO2lmKHR5cGVvZiBkb2N1bWVudCE9PVwidW5kZWZpbmVkXCIpe2xvYWRTY3JpcHQoXCJodHRwczovL3d3dy55b3V0dWJlLmNvbS9pZnJhbWVfYXBpXCIsYXBpTG9hZGVkKTtpbmplY3RDc3MoKX1pZih0eXBlb2YgdmlkZW9qcy5yZWdpc3RlclRlY2ghPT1cInVuZGVmaW5lZFwiKXt2aWRlb2pzLnJlZ2lzdGVyVGVjaChcIllvdXR1YmVcIixZb3V0dWJlKX1lbHNle3ZpZGVvanMucmVnaXN0ZXJDb21wb25lbnQoXCJZb3V0dWJlXCIsWW91dHViZSl9fSk7Il0sImZpbGUiOiJsaWJzL1lvdXR1YmUubWluLmpzIn0=
